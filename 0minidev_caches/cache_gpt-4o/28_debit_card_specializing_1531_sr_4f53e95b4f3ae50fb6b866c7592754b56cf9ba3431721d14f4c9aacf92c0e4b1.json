"```python\ndf1 = df.groupby(transactions_1k.CustomerID).agg(total_spending=('transactions_1k.Price', 'sum'))\ndf2 = df1.orderby(by='total_spending', desc).limit(1)\ndf3 = df.where(element=transactions_1k.CustomerID, filter=df2.select(transactions_1k.CustomerID))\navg_price = df3.select(df3.agg(total_price=('transactions_1k.Price', 'sum')) / df3.agg(total_amount=('transactions_1k.Amount', 'sum')))\ncurrency = df3.select(customers.Currency).distinct()\nres = df2.select(customers.CustomerID, avg_price, currency)\n```"