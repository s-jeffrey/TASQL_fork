"```sql\nSELECT s.School, s.CharterNum\nFROM satscores ss\nJOIN schools s ON ss.cds = s.CDSCode\nWHERE ss.AvgScrWrite > 499 AND s.CharterNum IS NOT NULL\nORDER BY ss.AvgScrWrite DESC;\n```\n\nThis SQL query selects the school names and their charter numbers from the `satscores` and `schools` tables. It filters the results to include only those schools where the average score in Writing is greater than 499 and where the charter number is not null. The results are ordered by the average writing score in descending order to rank the schools."