"customers.Segment,\n       MAX(percentage_increase) AS Max_Percentage_Increase,\n       MIN(percentage_increase) AS Min_Percentage_Increase\nFROM (\n    SELECT c.Segment,\n           ((SUM(CASE WHEN SUBSTR(ym.Date, 1, 4) = '2013' THEN ym.Consumption ELSE 0 END) -\n             SUM(CASE WHEN SUBSTR(ym.Date, 1, 4) = '2012' THEN ym.Consumption ELSE 0 END)) /\n            SUM(CASE WHEN SUBSTR(ym.Date, 1, 4) = '2012' THEN ym.Consumption ELSE 0 END)) * 100 AS percentage_increase\n    FROM customers c\n    INNER JOIN yearmonth ym\n    ON c.CustomerID = ym.CustomerID\n    WHERE c.Currency = 'EUR'\n    AND (SUBSTR(ym.Date, 1, 4) = '2012' OR SUBSTR(ym.Date, 1, 4) = '2013')\n    GROUP BY c.Segment\n) AS results\nGROUP BY Segment;"