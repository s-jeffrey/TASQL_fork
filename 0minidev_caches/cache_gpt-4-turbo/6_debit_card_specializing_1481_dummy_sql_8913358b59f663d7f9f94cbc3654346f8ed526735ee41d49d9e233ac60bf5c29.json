"(SME_avg - LAM_avg) AS SME_LAM_Difference,\n       (LAM_avg - KAM_avg) AS LAM_KAM_Difference,\n       (KAM_avg - SME_avg) AS KAM_SME_Difference\nFROM (\n    SELECT \n        AVG(CASE WHEN c.Segment = 'SME' THEN ym.Consumption END) AS SME_avg,\n        AVG(CASE WHEN c.Segment = 'LAM' THEN ym.Consumption END) AS LAM_avg,\n        AVG(CASE WHEN c.Segment = 'KAM' THEN ym.Consumption END) AS KAM_avg\n    FROM yearmonth ym\n    JOIN customers c ON ym.CustomerID = c.CustomerID\n    WHERE ym.Date BETWEEN '201301' AND '201312'\n      AND c.Currency = 'CZK'\n) AS averages;\"\n  "