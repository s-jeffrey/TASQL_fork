"SR = \"df1 = df.where(element = customers.Currency, filter = 'CZK').where(element = yearmonth.Date, filter = 'between 201301 and 201312')\n    df2 = df1.groupby(customers.Segment).agg({'yearmonth.Consumption': 'sum', 'customers.CustomerID': 'count'})\n    df2 = df2.select(customers.Segment, df2['yearmonth.Consumption'] / df2['customers.CustomerID'] as 'AnnualAvgConsumption')\n    df3 = df2.where(element = customers.Segment, filter = 'SME')\n    df4 = df2.where(element = customers.Segment, filter = 'LAM')\n    df5 = df2.where(element = customers.Segment, filter = 'KAM')\n    res = df.select(df3['AnnualAvgConsumption'] - df4['AnnualAvgConsumption'], df4['AnnualAvgConsumption'] - df5['AnnualAvgConsumption'], df5['AnnualAvgConsumption'] - df3['AnnualAvgConsumption'])\""