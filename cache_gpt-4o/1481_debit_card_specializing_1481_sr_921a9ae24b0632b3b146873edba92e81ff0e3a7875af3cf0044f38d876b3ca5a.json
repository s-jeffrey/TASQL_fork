"```python\ndf1 = df.where(element = yearmonth.Date, filter = '>= 201301').where(element = yearmonth.Date, filter = '<= 201312')\n\ndf_sme = df1.where(element = customers.Segment, filter = 'SME')\ndf_lam = df1.where(element = customers.Segment, filter = 'LAM')\ndf_kam = df1.where(element = customers.Segment, filter = 'KAM')\n\nsme_min_consumption = df_sme.groupby(customers.CustomerID).sum(yearmonth.Consumption).min()\nlam_min_consumption = df_lam.groupby(customers.CustomerID).sum(yearmonth.Consumption).min()\nkam_min_consumption = df_kam.groupby(customers.CustomerID).sum(yearmonth.Consumption).min()\n\nsme_avg = df_sme.where(element = yearmonth.Consumption, filter = sme_min_consumption).sum(yearmonth.Consumption) / df_sme.where(element = yearmonth.Consumption, filter = sme_min_consumption).count()\nlam_avg = df_lam.where(element = yearmonth.Consumption, filter = lam_min_consumption).sum(yearmonth.Consumption) / df_lam.where(element = yearmonth.Consumption, filter = lam_min_consumption).count()\nkam_avg = df_kam.where(element = yearmonth.Consumption, filter = kam_min_consumption).sum(yearmonth.Consumption) / df_kam.where(element = yearmonth.Consumption, filter = kam_min_consumption).count()\n\ndiff_sme_lam = sme_avg - lam_avg\ndiff_lam_kam = lam_avg - kam_avg\ndiff_kam_sme = kam_avg - sme_avg\n\nres = df.select(diff_sme_lam, diff_lam_kam, diff_kam_sme)\n```"